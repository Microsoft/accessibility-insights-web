# Copyright (c) Microsoft Corporation. All rights reserved.
# Licensed under the MIT License.
parameters:
    - name: useCache
      type: boolean
      default: false

steps:
    - task: NodeTool@0
      inputs:
          versionSpec: '12.13.0'
      displayName: use node 12.13.0

    - script: npm install -g npm@6.11.1
      displayName: install npm 6.11.1

    - script: npm install yarn@1.17.3 -g
      displayName: install yarn as a global dependency

    - script: yarn cache dir

    - task: Cache@2
      inputs:
          key: 'yarn | "$(Agent.OS)" | yarn.lock'
          path: $(Pipeline.Workspace)/.yarn
      displayName: Cache Yarn packages
      condition: and(succeeded(), eq('${{ parameters.useCache }}', true))

    - script: yarn install --frozen-lockfile
      displayName: install packages and dependencies
