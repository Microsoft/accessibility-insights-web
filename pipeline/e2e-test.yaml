# Copyright (c) Microsoft Corporation. All rights reserved.
# Licensed under the MIT License.
steps:
    # e2e tests depend drop folder. run build:all will create said folder
    - script: yarn build:web-extension
      displayName: build:web-extension

    - bash: |
          echo "Hello world from $AGENT_NAME running on $AGENT_OS"
          export IPADDR=$(ip addr | grep 'state UP' -A2 | tail -n1 | awk '{print $2}' | cut -f1  -d'/')
          echo "##vso[task.setvariable variable=IP_ADDR]$IPADDR"
      condition: eq( variables['Agent.OS'], 'Linux' )
      displayName: Hello world

    - script: |
          echo The IP address is $(IP_ADDR)

    - script: yarn test:e2e -- --ci
      displayName: run e2e tests
